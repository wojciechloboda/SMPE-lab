ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "rq", formula = y ~ x, se = TRUE, color = "red", fill = "pink", alpha = 0.3, method.args = list(tau = tau)) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented)
library(ggplot2)
library(dplyr)
library(patchwork)
install.packages("quantreg", dependencies = TRUE)
install.packages("patchwork")
install.packages("quantreg")
library(ggplot2)
library(dplyr)
library(patchwork)
library(quantreg)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
# Plot
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "rq", formula = y ~ x, se = TRUE, color = "red", fill = "pink", alpha = 0.3, method.args = list(tau = tau)) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented)
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "rq", formula = y ~ x, se = TRUE,
color = "red", fill = "pink", alpha = 0.3,
method.args = list(tau = tau)) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "rq", formula = y ~ x, se = TRUE,
color = "red", fill = "pink", alpha = 0.3,
method.args = list(tau = tau)) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
# Generate predicted values for the line
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
# Plot points + quantile regression line
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
# Generate predicted values for the line
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
# Plot points + quantile regression line
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
# Compute residuals
residuals <- data$ping_ms - predict(reg, newdata = data)
# Print quantiles of residuals
res_quantiles <- quantile(residuals, probs = c(0, 0.25, 0.5, 0.75, 1))
cat("Residual quantiles (min, 25%, median, 75%, max):\n")
print(res_quantiles)
# Generate predicted values for the line
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
# Plot points + quantile regression line
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression(data_unfragmented_min, 0.75)
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
residuals <- data$ping_ms - predict(reg, newdata = data)
res_quantiles <- quantile(residuals, probs = c(0, 0.25, 0.5, 0.75, 1))
cat("Residual quantiles (min, 25%, median, 75%, max):\n")
print(res_quantiles)
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression(data_unfragmented, 0.50)
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression(data_unfragmented, 0.50)
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
residuals <- data$ping_ms - predict(reg, newdata = data)
res_quantiles <- quantile(residuals, probs = c(0, 0.25, 0.5, 0.75, 1))
cat("Residual quantiles (min, 25%, median, 75%, max):\n")
print(res_quantiles)
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression(data_unfragmented, 0.50)
summarize_qregression(data_unfragmented, 0.75)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
residuals <- data$ping_ms - predict(reg, newdata = data)
res_quantiles <- quantile(residuals, probs = c(0, 0.25, 0.5, 0.75, 1))
cat("Residual quantiles (min, 25%, median, 75%, max):\n")
print(res_quantiles)
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
ylim(0, 5) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression(data_unfragmented, 0.50)
summarize_qregression(data_unfragmented, 0.75)
summarize_regression <- function(data) {
reg <- lm(data=data, ping_ms~size_bytes)
summary(reg)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
print(paste("C: ", inv_coef))
print(paste("L: ", coef(reg)["(Intercept)"]))
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "blue", fill = "lightblue", alpha = 0.3) +
labs(
title = "Ping vs Payload Size with Regression Line",
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
ylim(0, 5) +
theme_minimal()
}
summarize_regression(data_unfragmented)
summarize_regression(data_fragmented)
data_unfragmented_min <- data_unfragmented %>%
group_by(size_bytes) %>%
slice_min(times, n = 1) %>%
ungroup()
data_fragmented_min <- data_fragmented %>%
group_by(size_bytes) %>%
slice_min(times, n = 1) %>%
ungroup()
ggplot(data_unfragmented_min, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "min TT over msg size unfragmented",
x = "msg size",
y = "Ping (ms)"
) +
theme_minimal()
ggplot(data_fragmented_min, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "min TT over msg size fragmented",
x = "msg size",
y = "Ping (ms)"
) +
theme_minimal()
summarize_regression(data_fragmented_min)
summarize_regression(data_unfragmented_min)
summarize_qregression <- function(data, tau = 0.5) {
reg <- rq(ping_ms ~ size_bytes, data = data, tau = tau)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
cat("C (1/coef_size):", inv_coef, "\n")
cat("L (intercept):", coef(reg)["(Intercept)"], "\n")
residuals <- data$ping_ms - predict(reg, newdata = data)
res_quantiles <- quantile(residuals, probs = c(0, 0.25, 0.5, 0.75, 1))
cat("Residual quantiles (min, 25%, median, 75%, max):\n")
print(res_quantiles)
new_data <- data.frame(size_bytes = seq(min(data$size_bytes),
max(data$size_bytes), length.out = 100))
new_data$ping_pred <- predict(reg, newdata = new_data)
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_line(data = new_data, aes(x = size_bytes, y = ping_pred),
color = "red", size = 1) +
labs(
title = paste("Ping vs Payload Size with Quantile Regression (tau =", tau, ")"),
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
ylim(0, 5) +
theme_minimal()
}
summarize_qregression(data_unfragmented, 0.25)
summarize_qregression(data_unfragmented, 0.50)
summarize_qregression(data_unfragmented, 0.75)
summarize_regression <- function(data) {
reg <- lm(data=data, ping_ms~size_bytes)
summary(reg)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
print(paste("C: ", inv_coef))
print(paste("L: ", coef(reg)["(Intercept)"]))
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "blue", fill = "lightblue", alpha = 0.3) +
labs(
title = "Ping vs Payload Size with Regression Line",
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
ylim(0, 5) +
theme_minimal()
}
summarize_regression(data_unfragmented)
summarize_regression(data_fragmented)
data_unfragmented_min <- data_unfragmented %>%
group_by(size_bytes) %>%
slice_min(times, n = 1) %>%
ungroup()
data_fragmented_min <- data_fragmented %>%
group_by(size_bytes) %>%
slice_min(times, n = 1) %>%
ungroup()
data <- parse_ping_log("stackoverflow.log")
str(data)
ggplot(data, aes(x = times, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "Ping over Time",
x = "Time",
y = "Ping (ms)"
) +
theme_minimal()
plot_means_for_timerange(data, "1 min")
plot_means_for_timerange(data, "5 min")
plot_means_for_timerange(data, "10 min")
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "TT over msg size",
x = "msg size",
y = "Ping (ms)"
) +
theme_minimal()
threshold <- 1472
data_unfragmented <- data[data$size_bytes <= threshold, ]
data_fragmented <- data[data$size_bytes > threshold, ]
str(data_fragmented)
str(data_unfragmented)
ggplot(data_unfragmented, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "TT over msg size unfragmented",
x = "msg size",
y = "Ping (ms)"
) +
theme_minimal()
ggplot(data_fragmented, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "TT over msg size fragmented",
x = "msg size",
y = "Ping (ms)"
) +
theme_minimal()
summarize_regression(data_unfragmented)
summarize_regression <- function(data, maxY) {
reg <- lm(data=data, ping_ms~size_bytes)
summary(reg)
coef_size <- coef(reg)["size_bytes"]
inv_coef <- 1 / coef_size
print(summary(reg))
print(paste("C: ", inv_coef))
print(paste("L: ", coef(reg)["(Intercept)"]))
ggplot(data, aes(x = size_bytes, y = ping_ms)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", se = TRUE, color = "blue", fill = "lightblue", alpha = 0.3) +
labs(
title = "Ping vs Payload Size with Regression Line",
x = "Payload Size (bytes)",
y = "Ping (ms)"
) +
ylim(0, maxY) +
theme_minimal()
}
summarize_regression(data_unfragmented, 5)
lines <- readLines("liglab2.log", warn = FALSE)
paste("Original number of lines : ", length(lines))
lines <- lines[grepl("bytes from .* time=", lines)]
paste("Number of lines with successful pings: ", length(lines))
parse_ping_log <- function(file) {
lines <- readLines(file, warn = FALSE)
lines <- lines[grepl("bytes from .* time=", lines)]
timestamps <- as.numeric(sub("^\\[(\\d+\\.\\d+)\\].*", "\\1", lines))
times <- as.POSIXct(timestamps, origin="1970-01-01", tz="UTC")
size_bytes <- as.numeric(sub("^.*\\] ([0-9]+) bytes.*$", "\\1", lines))
ping_ms <- as.numeric(sub("^.*time=([0-9.]+) ms.*$", "\\1", lines))
data.frame(
times = times,
size_bytes = size_bytes,
ping_ms = ping_ms,
stringsAsFactors = FALSE
)
}
data <- parse_ping_log("liglab2.log")
str(data)
ggplot(data, aes(x = times, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "Ping over Time",
x = "Time",
y = "Ping (ms)"
) +
theme_minimal()
data <- data[data$ping_ms <= 100, ]
ggplot(data, aes(x = times, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = "Ping over Time within the treshold",
x = "Time",
y = "Ping (ms)"
) +
theme_minimal()
library(dplyr)
library(ggplot2)
library(patchwork)
plot_means_for_timerange <- function(data, timerange) {
data_min <- data %>%
mutate(time_min = as.POSIXct(cut(times, timerange))) %>%
group_by(time_min) %>%
summarise(avg_ping = mean(ping_ms, na.rm = TRUE),
avg_size = mean(size_bytes, na.rm = TRUE))
p1 <- ggplot(data_min, aes(x = time_min, y = avg_ping)) +
geom_line(color = "blue") +
geom_point(alpha = 0.3, size = 1) +
labs(title = "Average Ping per Time Range",
x = "Time",
y = "Ping (ms)") +
theme_minimal()
p2 <- ggplot(data_min, aes(x = time_min, y = avg_size)) +
geom_line(color = "blue") +
geom_point(alpha = 0.3, size = 1) +
labs(title = "Average Size per Time Range",
x = "Time",
y = "Size") +
theme_minimal()
p1 + p2
}
plot_means_for_timerange(data, "1 min")
plot_means_for_timerange(data, "10 min")
plot_means_for_timerange(data, "20 min")
plot_for_timerange <- function(data, begin, end) {
# Filter by time-of-day
time_str <- format(data$times, "%H:%M")
data_range <- data[time_str >= begin & time_str < end, ]
p_ping <- ggplot(data_range, aes(x = times, y = ping_ms)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = paste("Ping over Time from", begin, "to", end),
x = "Time",
y = "Ping (ms)"
) +
theme_minimal()
p_size <- ggplot(data_range, aes(x = times, y = size_bytes)) +
geom_point(alpha = 0.3, size = 0.8) +
labs(
title = paste("Size over Time from", begin, "to", end),
x = "Time",
y = "Size (bytes)"
) +
theme_minimal()
p_ping + p_size
}
plot_for_timerange(data, "15:00", "16:00")
plot_for_timerange(data, "15:00", "15:10")
plot_for_timerange(data, "15:00", "15:01")
plot_for_timerange(data, "15:00", "16:00")
plot_for_timerange(data, "15:00", "15:10")
plot_for_timerange(data, "15:00", "15:01")
